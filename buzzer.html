<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Realistic Game Buzzer</title>
    <style>
        :root {
            --primary: #eb4d4b; /* Default Red */
            --primary-dark: #c0392b;
            --bg: #1e272e;
            --text: #ffffff;
        }

        * { box-sizing: border-box; user-select: none; -webkit-tap-highlight-color: transparent; }
        
        body {
            margin: 0;
            padding: 0;
            height: 100vh;
            background-color: var(--bg);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transition: background-color 0.4s ease;
        }

        /* Header Area */
        header {
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            z-index: 20;
        }
        
        h1 {
            margin: 0;
            color: white;
            font-size: 1.2rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            opacity: 0.8;
        }

        /* Volume Reminder */
        .volume-alert {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(4px);
            padding: 10px 20px;
            border-radius: 50px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: white;
            font-weight: 600;
            font-size: 1rem;
            animation: pulse-border 2s infinite;
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        @keyframes pulse-border {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.4); }
            70% { transform: scale(1.02); box-shadow: 0 0 0 10px rgba(255, 255, 255, 0); }
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 255, 255, 0); }
        }

        /* Main Button Area */
        main {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        #buzzer-btn {
            width: min(75vw, 300px);
            height: min(75vw, 300px);
            border-radius: 50%;
            border: none;
            background: linear-gradient(145deg, var(--primary), var(--primary-dark));
            box-shadow: 
                0 15px 0 var(--primary-dark), 
                0 25px 20px rgba(0,0,0,0.4),
                inset 0 10px 20px rgba(255,255,255,0.25);
            color: white;
            font-size: 2.5rem;
            font-weight: 800;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
            cursor: pointer;
            position: relative;
            transition: all 0.05s cubic-bezier(0.1, 0.7, 1.0, 0.1);
            outline: none;
            touch-action: manipulation;
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
            -webkit-appearance: none; /* iOS fix */
        }

        #buzzer-btn:active, #buzzer-btn.pressed {
            transform: translateY(15px);
            box-shadow: 
                0 0 0 var(--primary-dark), 
                0 10px 10px rgba(0,0,0,0.4);
        }

        /* Visual Ripple Effect */
        .ripple {
            position: absolute;
            border-radius: 50%;
            transform: scale(0);
            animation: ripple-anim 0.5s linear;
            background-color: rgba(255, 255, 255, 0.4);
            pointer-events: none;
        }

        @keyframes ripple-anim {
            to { transform: scale(3.5); opacity: 0; }
        }

        /* Footer / Theme Selector */
        .controls-container {
            background: rgba(0,0,0,0.3);
            backdrop-filter: blur(10px);
            padding-bottom: env(safe-area-inset-bottom, 20px);
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        .controls-label {
            padding: 15px 0 5px 20px;
            font-size: 0.8rem;
            text-transform: uppercase;
            color: rgba(255,255,255,0.5);
            letter-spacing: 1px;
        }

        .controls {
            display: flex;
            gap: 12px;
            padding: 10px 20px 20px 20px;
            overflow-x: auto;
            scrollbar-width: none; /* Firefox */
        }
        
        .controls::-webkit-scrollbar { display: none; } /* Chrome/Safari */
        
        .theme-card {
            min-width: 85px;
            height: 95px;
            background: #2d3436;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 0.75rem;
            font-weight: 600;
            opacity: 0.7;
            transition: all 0.2s ease;
            cursor: pointer;
            border: 2px solid transparent;
            flex-shrink: 0;
            position: relative;
        }

        .theme-card.active {
            opacity: 1;
            background: #353b48;
            border-color: white;
            transform: translateY(-4px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .theme-icon { font-size: 2rem; margin-bottom: 8px; }

        /* Shake Animation for Whole Screen */
        .shake { animation: shake 0.2s cubic-bezier(.36,.07,.19,.97) both; }
        @keyframes shake {
            10%, 90% { transform: translate3d(-2px, 0, 0); }
            20%, 80% { transform: translate3d(4px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-6px, 0, 0); }
            40%, 60% { transform: translate3d(6px, 0, 0); }
        }

    </style>
</head>
<body>

    <header>
        <h1>Game Buzzer</h1>
        <div class="volume-alert">
            <span>üîä</span>
            <span>Turn up volume!</span>
        </div>
    </header>

    <main>
        <button id="buzzer-btn">PUSH</button>
    </main>

    <div class="controls-container">
        <div class="controls-label">Select Sound</div>
        <div class="controls">
            <!-- 1. Buzzer (Default) -->
            <div class="theme-card active" onclick="setTheme('buzzer')" data-theme="buzzer">
                <span class="theme-icon">üö®</span>
                <span>Buzzer</span>
            </div>
            <!-- 2. Applause -->
            <div class="theme-card" onclick="setTheme('applause')" data-theme="applause">
                <span class="theme-icon">üëè</span>
                <span>Applause</span>
            </div>
            <!-- 3. Cheer -->
            <div class="theme-card" onclick="setTheme('cheer')" data-theme="cheer">
                <span class="theme-icon">üéâ</span>
                <span>Cheer</span>
            </div>
            <!-- 4. Laser -->
            <div class="theme-card" onclick="setTheme('laser')" data-theme="laser">
                <span class="theme-icon">üî´</span>
                <span>Laser</span>
            </div>
            <!-- 5. Dog -->
            <div class="theme-card" onclick="setTheme('dog')" data-theme="dog">
                <span class="theme-icon">üê∂</span>
                <span>Dog</span>
            </div>
            <!-- 6. Meow -->
            <div class="theme-card" onclick="setTheme('meow')" data-theme="meow">
                <span class="theme-icon">üê±</span>
                <span>Meow</span>
            </div>
             <!-- 7. Lion -->
             <div class="theme-card" onclick="setTheme('lion')" data-theme="lion">
                <span class="theme-icon">ü¶Å</span>
                <span>Lion</span>
            </div>
        </div>
    </div>

    <script>
        // --- AUDIO CONFIGURATION ---
        
        // Reliable Sound Sources (Mixkit / Pixabay / Google)
        const themes = {
            buzzer: { 
                color: '#eb4d4b', 
                dark: '#c0392b',
                url: 'https://assets.mixkit.co/active_storage/sfx/950/950-preview.mp3' 
            },
            applause: { 
                color: '#6c5ce7', 
                dark: '#5f27cd',
                url: 'https://cdn.pixabay.com/audio/2021/08/04/audio_12b0c7443c.mp3'
            },
            cheer: { 
                color: '#00b894', 
                dark: '#009432',
                url: 'https://assets.mixkit.co/active_storage/sfx/2013/2013-preview.mp3' 
            },
            laser: { 
                color: '#0984e3', 
                dark: '#0652dd',
                url: 'https://assets.mixkit.co/active_storage/sfx/1678/1678-preview.mp3'
            },
            dog: { 
                color: '#e67e22', 
                dark: '#d35400',
                url: 'https://www.google.com/logos/fnbx/animal_sounds/dog.mp3'
            },
            meow: { 
                color: '#fd79a8', 
                dark: '#e84393',
                url: 'https://www.google.com/logos/fnbx/animal_sounds/cat.mp3'
            },
            lion: { 
                color: '#f1c40f', 
                dark: '#f39c12',
                url: 'https://www.google.com/logos/fnbx/animal_sounds/lion.mp3'
            }
        };

        // --- AUDIO ENGINE ---
        
        // Master player used for Pre-loading
        const masterPlayer = new Audio();
        let currentTheme = 'buzzer';
        let wakeLock = null;

        // Error listener
        masterPlayer.addEventListener('error', (e) => {
            console.error("Error loading sound:", masterPlayer.src, e);
        });

        // Initialize
        function init() {
            setTheme('buzzer');
            
            // Interaction Listener for:
            // 1. Audio Unlocking (iOS)
            // 2. Wake Lock Request
            const unlockHandler = async function() {
                // Audio warm up
                masterPlayer.load();
                
                // Request Wake Lock
                requestWakeLock();
                
                // Remove listener after first interaction
                document.body.removeEventListener('touchstart', unlockHandler);
                document.body.removeEventListener('click', unlockHandler);
            };

            document.body.addEventListener('touchstart', unlockHandler);
            document.body.addEventListener('click', unlockHandler);
            
            // Re-acquire lock if tab visibility changes
            document.addEventListener('visibilitychange', async () => {
                if (wakeLock !== null && document.visibilityState === 'visible') {
                    requestWakeLock();
                }
            });
        }

        // --- WAKE LOCK (Keep Screen On) ---
        async function requestWakeLock() {
            try {
                if ('wakeLock' in navigator) {
                    wakeLock = await navigator.wakeLock.request('screen');
                    console.log('Wake Lock active');
                    wakeLock.addEventListener('release', () => {
                        console.log('Wake Lock released');
                    });
                }
            } catch (err) {
                // Wake Lock might be denied if battery is low or not allowed
                console.log('Wake Lock denied:', err.name, err.message);
            }
        }

        // --- THEME & AUDIO LOGIC ---

        window.setTheme = function(themeKey) {
            currentTheme = themeKey;
            const config = themes[themeKey];
            
            // 1. Visual Updates
            const root = document.documentElement;
            root.style.setProperty('--primary', config.color);
            root.style.setProperty('--primary-dark', config.dark);
            
            document.querySelectorAll('.theme-card').forEach(card => {
                card.classList.remove('active');
                if(card.dataset.theme === themeKey) card.classList.add('active');
            });

            // 2. Audio Pre-loading
            // We set source on the master player to force the browser to buffer it
            masterPlayer.src = config.url;
            masterPlayer.load(); 
        };

        function playSound() {
            // POLYPHONY IMPLEMENTATION:
            // Instead of playing 'masterPlayer' directly (which would cut off previous sounds),
            // we clone the node. This creates a lightweight copy that shares the 
            // buffered audio data, allowing for "Spamming" / Overlapping sounds.
            
            const clone = masterPlayer.cloneNode();
            
            // Play the clone
            const promise = clone.play();
            
            if (promise !== undefined) {
                promise.catch(error => {
                    console.log("Autoplay prevented or network error.", error);
                });
            }
            
            // Optional: Garbage collection helper (though browsers handle this well)
            clone.addEventListener('ended', () => {
                clone.remove();
            });
        }

        // --- INTERACTION HANDLING ---

        const btn = document.getElementById('buzzer-btn');

        function triggerBuzzer(e) {
            if(e.cancelable && e.type === 'touchstart') e.preventDefault();
            
            // 1. HAPTIC FEEDBACK (Vibration)
            if (navigator.vibrate) {
                navigator.vibrate(50); // 50ms pulse
            }

            // 2. Sound (Polyphonic)
            playSound();

            // 3. Visuals
            btn.classList.add('pressed');
            
            // Screen Shake
            document.body.classList.remove('shake');
            void document.body.offsetWidth; // Force reflow
            document.body.classList.add('shake');

            // Ripple
            createRipple(e);
        }

        function releaseBuzzer() {
            btn.classList.remove('pressed');
        }

        function createRipple(e) {
            const circle = document.createElement("span");
            const diameter = Math.max(btn.clientWidth, btn.clientHeight);
            const radius = diameter / 2;
            
            let clientX, clientY;
            if (e.touches && e.touches.length > 0) {
                clientX = e.touches[0].clientX;
                clientY = e.touches[0].clientY;
            } else {
                clientX = e.clientX;
                clientY = e.clientY;
            }

            const rect = btn.getBoundingClientRect();
            
            circle.style.width = circle.style.height = `${diameter}px`;
            circle.style.left = `${clientX - rect.left - radius}px`;
            circle.style.top = `${clientY - rect.top - radius}px`;
            circle.classList.add("ripple");

            const existing = btn.getElementsByClassName("ripple");
            while (existing.length > 1) { existing[0].remove(); }

            btn.appendChild(circle);
        }

        // Event Listeners
        btn.addEventListener('touchstart', triggerBuzzer, { passive: false });
        btn.addEventListener('touchend', releaseBuzzer);
        
        btn.addEventListener('mousedown', triggerBuzzer);
        btn.addEventListener('mouseup', releaseBuzzer);
        btn.addEventListener('mouseleave', releaseBuzzer);

        // Start
        init();

    </script>
</body>
</html>